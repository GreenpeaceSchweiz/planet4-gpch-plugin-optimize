(()=>{"use strict";var e,t={114:()=>{const e=window.wp.blocks,t=window.wp.i18n,n=window.wp.primitives,i=window.ReactJSXRuntime,a=(0,i.jsx)(n.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,i.jsx)(n.Path,{d:"M19.5 4.5h-7V6h4.44l-5.97 5.97 1.06 1.06L18 7.06v4.44h1.5v-7Zm-13 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-3H17v3a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h3V5.5h-3Z"})}),l=(0,i.jsx)(n.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,i.jsx)(n.Path,{fillRule:"evenodd",d:"M6.5 8a1.5 1.5 0 103 0 1.5 1.5 0 00-3 0zM8 5a3 3 0 100 6 3 3 0 000-6zm6.5 11a1.5 1.5 0 103 0 1.5 1.5 0 00-3 0zm1.5-3a3 3 0 100 6 3 3 0 000-6zM5.47 17.41a.75.75 0 001.06 1.06L18.47 6.53a.75.75 0 10-1.06-1.06L5.47 17.41z",clipRule:"evenodd"})}),o=window.wp.blockEditor,s=window.wp.components,r=(0,i.jsx)(n.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,i.jsx)(n.Path,{d:"m21.5 9.1-6.6-6.6-4.2 5.6c-1.2-.1-2.4.1-3.6.7-.1 0-.1.1-.2.1-.5.3-.9.6-1.2.9l3.7 3.7-5.7 5.7v1.1h1.1l5.7-5.7 3.7 3.7c.4-.4.7-.8.9-1.2.1-.1.1-.2.2-.3.6-1.1.8-2.4.6-3.6l5.6-4.1zm-7.3 3.5.1.9c.1.9 0 1.8-.4 2.6l-6-6c.8-.4 1.7-.5 2.6-.4l.9.1L15 4.9 19.1 9l-4.9 3.6z"})}),p=(0,i.jsx)(n.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,i.jsx)(n.Path,{d:"M11 12.5V17.5H12.5V12.5H17.5V11H12.5V6H11V11H6V12.5H11Z"})}),c=window.wp.element,g=(0,i.jsx)(n.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,i.jsx)(n.Path,{d:"m19 7-3-3-8.5 8.5-1 4 4-1L19 7Zm-7 11.5H5V20h7v-1.5Z"})}),u=(0,i.jsx)(n.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,i.jsx)(n.Path,{d:"M12 13.06l3.712 3.713 1.061-1.06L13.061 12l3.712-3.712-1.06-1.06L12 10.938 8.288 7.227l-1.061 1.06L10.939 12l-3.712 3.712 1.06 1.061L12 13.061z"})}),d=({index:e,conditional:n,onSaveConditionals:a,onRemoveConditional:l})=>{var o,r,p,d,m,_,h,v;const[x,w]=(0,c.useState)(null!==(o=n.type)&&void 0!==o?o:"url_parameter"),[z,j]=(0,c.useState)(null!==(r=n.typeSelection)&&void 0!==r?r:null),[S,b]=(0,c.useState)(null!==(p=n.nameInStorage)&&void 0!==p?p:"gp_optimize_data"),[f,C]=(0,c.useState)(null!==(d=n.dataType)&&void 0!==d?d:"string"),[B,V]=(0,c.useState)(null!==(m=n.conditionalKey)&&void 0!==m?m:""),[k,N]=(0,c.useState)(null!==(_=n.operator)&&void 0!==_?_:"is"),[y,M]=(0,c.useState)(null!==(h=n.value)&&void 0!==h?h:""),[L,P]=(0,c.useState)(null!==(v=n.showDetails)&&void 0!==v&&v);return(0,i.jsxs)(i.Fragment,{children:[!1===L&&(0,i.jsxs)("div",{className:"conditional-container",children:[(0,i.jsxs)("div",{className:"buttons",children:[(0,i.jsx)(s.Button,{onClick:()=>P(!0),variant:"link",icon:g,size:"small",iconSize:20}),(0,i.jsx)(s.Button,{onClick:()=>l(e),variant:"link",icon:u,size:"small",iconSize:20})]}),(0,i.jsx)("div",{className:"info",children:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("p",{children:(0,i.jsxs)("b",{children:["utm_medium"===z&&(0,t.__)("UTM Medium in URL:","planet4-gpch-plugin-optimize"),"utm_source"===z&&(0,t.__)("UTM Source in URL:","planet4-gpch-plugin-optimize"),"utm_campaign"===z&&(0,t.__)("UTM Campaign in URL:","planet4-gpch-plugin-optimize"),"url_parameter"===z&&(0,t.__)("URL Parameter:","planet4-gpch-plugin-optimize"),"local_storage"===z&&(0,t.__)("LocalStorage:","planet4-gpch-plugin-optimize"),"session_storage"===z&&(0,t.__)("SessionStorage:","planet4-gpch-plugin-optimize")]})}),("local_storage"===z||"session_storage"===z)&&(0,i.jsxs)("p",{children:[(0,t.__)("Name in storage:","planet4-gpch-plugin-optimize")," ",(0,i.jsx)("code",{children:S})," (",f,")"]}),(0,i.jsxs)("p",{children:[""!==B&&(0,i.jsx)("code",{children:B}),(0,i.jsxs)("span",{children:["is"===k&&" == ","is_not"===k&&" != ","contains"===k&&" contains ","does_not_contain"===k&&" does not contain "]}),(0,i.jsx)("code",{children:y})]})]})})]}),!0===L&&(0,i.jsxs)("div",{className:"conditional-container",children:[(0,i.jsx)(s.SelectControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:(0,t.__)("Force this variant when","planet4-gpch-plugin-optimize"),onChange:e=>{"utm_medium"===e?(w("url_parameter"),j(e),V("utm_medium")):"utm_source"===e?(w("url_parameter"),j(e),V("utm_source")):"utm_campaign"===e?(w("url_parameter"),j(e),V("utm_campaign")):(j(e),w(e)),V("")},options:[{label:(0,t.__)("Query parameter in URL","planet4-gpch-plugin-optimize"),value:"url_parameter"},{label:(0,t.__)("utm_medium in URL","planet4-gpch-plugin-optimize"),value:"utm_medium"},{label:(0,t.__)("utm_source in URL","planet4-gpch-plugin-optimize"),value:"utm_source"},{label:(0,t.__)("utm_campaign in URL","planet4-gpch-plugin-optimize"),value:"utm_campaign"},{label:(0,t.__)("Data in LocalStorage","planet4-gpch-plugin-optimize"),value:"local_storage"},{label:(0,t.__)("Data in SessionStorage","planet4-gpch-plugin-optimize"),value:"session_storage"}],value:z}),("local_storage"===z||"session_storage"===z)&&(0,i.jsx)(s.TextControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:(0,t.__)("Name in Storage","planet4-gpch-plugin-optimize"),onChange:b,value:S}),(0,i.jsxs)("div",{className:"conditional-details",children:[("local_storage"===z||"session_storage"===z)&&(0,i.jsx)(s.SelectControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:(0,t.__)("Data type","planet4-gpch-plugin-optimize"),onChange:C,options:[{label:(0,t.__)("String","planet4-gpch-plugin-optimize"),value:"string"},{label:(0,t.__)("Comma separated list","planet4-gpch-plugin-optimize"),value:"comma_separated"},{label:(0,t.__)("Object","planet4-gpch-plugin-optimize"),value:"object"}],value:f}),!("local_storage"===z&&"string"===f||"local_storage"===z&&"comma_separated"===f||"session_storage"===z&&"string"===f||"session_storage"===z&&"comma_separated"===f||"utm_medium"===z||"utm_source"===z||"utm_campaign"===z)&&(0,i.jsx)(s.TextControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:(0,t.__)("Key","planet4-gpch-plugin-optimize"),onChange:V,value:B}),(0,i.jsx)(s.SelectControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:(0,t.__)("Operator","planet4-gpch-plugin-optimize"),onChange:N,value:k,options:[..."comma_separated"!==f?[{label:(0,t.__)("is (==)","planet4-gpch-plugin-optimize"),value:"is"}]:[],..."comma_separated"!==f?[{label:(0,t.__)("is not (!=)","planet4-gpch-plugin-optimize"),value:"is_not"}]:[],{label:(0,t.__)("contains","planet4-gpch-plugin-optimize"),value:"contains"},{label:(0,t.__)("does not contain","planet4-gpch-plugin-optimize"),value:"does_not_contain"}]}),(0,i.jsx)(s.TextControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:(0,t.__)("Value","planet4-gpch-plugin-optimize"),onChange:M,value:y}),(0,i.jsx)(s.Button,{onClick:()=>(P(!1),void a({index:e,type:x,typeSelection:z,nameInStorage:S,dataType:f,conditionalKey:B,operator:k,value:y,showDetails:!1})),variant:"primary",children:(0,t.__)("Save","planet4-gpch-plugin-optimize")}),(0,i.jsx)(s.Button,{onClick:()=>l(e),variant:"secondary",isDestructive:!0,children:(0,t.__)("Remove","planet4-gpch-plugin-optimize")})]})]})]})},m=({conditionals:e,setAttributes:n})=>{const[a,l]=(0,c.useState)(0),o=t=>{e[t.index]=t},g=t=>{const i=e.filter(((e,n)=>n!==t));n({conditionals:i}),l(i.length)};return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(s.PanelBody,{title:(0,t.__)("Override Variant Targeting","planet4-gpch-plugin-optimize"),icon:r,initialOpen:!0,children:[(0,i.jsx)("p",{children:(0,i.jsx)("b",{children:(0,t.__)("Force this variant when either:","planet4-gpch-plugin-optimize")})}),(0,i.jsx)("div",{className:"conditionals-container",children:e.map(((e,t)=>(0,i.jsx)(d,{index:t,conditional:e,onSaveConditionals:o,onRemoveConditional:g},t)))}),(0,i.jsx)(s.Button,{__next40pxDefaultSize:!0,variant:"secondary",icon:p,iconSize:20,className:"add-conditional-button",onClick:()=>(n({conditionals:[...e,{showDetails:!0}]}),void l(a+1)),children:(0,t.__)("Add Condition","planet4-gpch-plugin-optimize")})]})})},{useSelect:_}=wp.data,h=JSON.parse('{"UU":"planet4-gpch-plugin-optimize/variant"}');(0,e.registerBlockType)(h.UU,{icon:function(){return(0,i.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",className:"icon",viewBox:"0 0 30.7 30.7",children:[(0,i.jsx)("path",{fill:"#131313",d:"M30 30.7h-8V3.5a1.6 1.6 0 0 1 1.6-1.6h4.7c1 0 1.6.8 1.6 1.6v27.2Zm-6.7-1.3h5.3V3.5c0-.2-.1-.3-.2-.3h-4.8l-.2.1v26.1Zm-4 1.3h-8V10c0-.8.7-1.4 1.5-1.4h5c.9 0 1.5.6 1.5 1.4v20.7Zm-6.6-1.3H18V10l-.2-.1h-5l-.2.1v19.4zm-4 1.3h-8V16.4c0-.8.7-1.3 1.4-1.3h5.3c.7 0 1.3.5 1.3 1.3zm-6.6-1.3h5.3v-13H2.1Z"}),(0,i.jsx)("path",{fill:"#121212",d:"M22.9 2.7h6.3v27h-6.3z"})]})},edit:function({attributes:e,setAttributes:n,context:r}){let{variantId:p,variantName:c,targetPercentage:g,conditionals:u}=e;if(void 0===p){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=8;p="";for(let n=0;n<t;n++)p+=e.charAt(Math.floor(Math.random()*e.length));n({variantId:p})}void 0===c&&(c=p),void 0===g&&(g=50),void 0===u&&(u=[]);const{currentPostLink:d}=_((e=>({currentPostLink:e("core/editor").getCurrentPost().link})),[]),h=`${d}${d.includes("?")?"&":"?"}force_variant=${encodeURIComponent(p)}`;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(o.InspectorControls,{children:[(0,i.jsxs)(s.PanelBody,{title:(0,t.__)("Variant Settings","planet4-gpch-plugin-optimize"),children:[(0,i.jsxs)("p",{children:[(0,i.jsx)("b",{children:"Variant ID: "}),p||""]}),(0,i.jsx)(s.TextControl,{__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0,label:(0,t.__)("Variant Name","planet4-gpch-plugin-optimize"),value:c||"",onChange:e=>n({variantName:e}),help:(0,t.__)("Used to identify the Variant in Mixpanel. Feel free to use a readable name. Don't change once the experiment has started!","planet4-gpch-plugin-optimize")}),(0,i.jsx)(s.Button,{__next40pxDefaultSize:!0,icon:a,variant:"link",href:h,target:"optimize-preview",rel:"noopener noreferrer",label:(0,t.__)("Opens the page for preview with this variant showing.","planet4-gpch-plugin-optimize"),showTooltip:!0,children:(0,t.__)("Preview Variant","planet4-gpch-plugin-optimize")})]}),(0,i.jsx)(s.PanelBody,{title:(0,t.__)("Targeting","planet4-gpch-plugin-optimize"),children:(0,i.jsx)(s.RangeControl,{__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0,label:"Target group percentage",afterIcon:l,value:g,onChange:e=>n({targetPercentage:e}),min:0,max:100,step:1,marks:[{value:25,label:"25%"},{value:50,label:"50%"},{value:75,label:"75%"},{value:100,label:"100%"}],railColor:"red",trackColor:"green"})}),(0,i.jsx)(m,{conditionals:u,setAttributes:n})]}),(0,i.jsx)("div",{children:(0,i.jsx)("div",{...(0,o.useBlockProps)(),children:e.variantId===r["content-optimization/editorSelectedVariantId"]&&(0,i.jsx)(o.InnerBlocks,{})})})]})},save:function({attributes:e}){return(0,i.jsx)("div",{...o.useBlockProps.save({className:"gp-optimize-variant"}),"data-target-percentage":e.targetPercentage,"data-variant-id":e.variantId,"data-variant-name":e.variantName,"data-conditionals":JSON.stringify(e.conditionals),children:(0,i.jsx)(o.InnerBlocks.Content,{})})}})}},n={};function i(e){var a=n[e];if(void 0!==a)return a.exports;var l=n[e]={exports:{}};return t[e](l,l.exports,i),l.exports}i.m=t,e=[],i.O=(t,n,a,l)=>{if(!n){var o=1/0;for(c=0;c<e.length;c++){for(var[n,a,l]=e[c],s=!0,r=0;r<n.length;r++)(!1&l||o>=l)&&Object.keys(i.O).every((e=>i.O[e](n[r])))?n.splice(r--,1):(s=!1,l<o&&(o=l));if(s){e.splice(c--,1);var p=a();void 0!==p&&(t=p)}}return t}l=l||0;for(var c=e.length;c>0&&e[c-1][2]>l;c--)e[c]=e[c-1];e[c]=[n,a,l]},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={222:0,290:0};i.O.j=t=>0===e[t];var t=(t,n)=>{var a,l,[o,s,r]=n,p=0;if(o.some((t=>0!==e[t]))){for(a in s)i.o(s,a)&&(i.m[a]=s[a]);if(r)var c=r(i)}for(t&&t(n);p<o.length;p++)l=o[p],i.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return i.O(c)},n=globalThis.webpackChunkplanet4_gpch_pluigin_optimize=globalThis.webpackChunkplanet4_gpch_pluigin_optimize||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var a=i.O(void 0,[290],(()=>i(114)));a=i.O(a)})();
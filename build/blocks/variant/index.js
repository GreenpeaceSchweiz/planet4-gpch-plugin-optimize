(()=>{"use strict";var e,t={114:()=>{const e=window.wp.blocks,t=window.wp.i18n,i=window.wp.primitives,n=window.ReactJSXRuntime,a=(0,n.jsx)(i.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,n.jsx)(i.Path,{d:"M19.5 4.5h-7V6h4.44l-5.97 5.97 1.06 1.06L18 7.06v4.44h1.5v-7Zm-13 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-3H17v3a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h3V5.5h-3Z"})}),o=(0,n.jsx)(i.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,n.jsx)(i.Path,{fillRule:"evenodd",d:"M6.5 8a1.5 1.5 0 103 0 1.5 1.5 0 00-3 0zM8 5a3 3 0 100 6 3 3 0 000-6zm6.5 11a1.5 1.5 0 103 0 1.5 1.5 0 00-3 0zm1.5-3a3 3 0 100 6 3 3 0 000-6zM5.47 17.41a.75.75 0 001.06 1.06L18.47 6.53a.75.75 0 10-1.06-1.06L5.47 17.41z",clipRule:"evenodd"})}),l=window.wp.blockEditor,s=window.wp.components,r=(0,n.jsx)(i.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,n.jsx)(i.Path,{d:"m21.5 9.1-6.6-6.6-4.2 5.6c-1.2-.1-2.4.1-3.6.7-.1 0-.1.1-.2.1-.5.3-.9.6-1.2.9l3.7 3.7-5.7 5.7v1.1h1.1l5.7-5.7 3.7 3.7c.4-.4.7-.8.9-1.2.1-.1.1-.2.2-.3.6-1.1.8-2.4.6-3.6l5.6-4.1zm-7.3 3.5.1.9c.1.9 0 1.8-.4 2.6l-6-6c.8-.4 1.7-.5 2.6-.4l.9.1L15 4.9 19.1 9l-4.9 3.6z"})}),p=(0,n.jsx)(i.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,n.jsx)(i.Path,{d:"M11 12.5V17.5H12.5V12.5H17.5V11H12.5V6H11V11H6V12.5H11Z"})}),c=window.wp.element,g=(0,n.jsx)(i.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,n.jsx)(i.Path,{d:"m19 7-3-3-8.5 8.5-1 4 4-1L19 7Zm-7 11.5H5V20h7v-1.5Z"})}),u=(0,n.jsx)(i.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,n.jsx)(i.Path,{d:"M12 13.06l3.712 3.713 1.061-1.06L13.061 12l3.712-3.712-1.06-1.06L12 10.938 8.288 7.227l-1.061 1.06L10.939 12l-3.712 3.712 1.06 1.061L12 13.061z"})}),_=({index:e,conditional:i,onSaveConditionals:a,onRemoveConditional:o})=>{var l,r,p,_,d,m,h,v;const[x,z]=(0,c.useState)(null!==(l=i.type)&&void 0!==l?l:"url_parameter"),[w,j]=(0,c.useState)(null!==(r=i.typeSelection)&&void 0!==r?r:null),[S,b]=(0,c.useState)(null!==(p=i.nameInStorage)&&void 0!==p?p:"gp_optimize_data"),[f,C]=(0,c.useState)(null!==(_=i.dataType)&&void 0!==_?_:"string"),[B,V]=(0,c.useState)(null!==(d=i.conditionalKey)&&void 0!==d?d:""),[k,N]=(0,c.useState)(null!==(m=i.operator)&&void 0!==m?m:"is"),[y,M]=(0,c.useState)(null!==(h=i.value)&&void 0!==h?h:""),[L,P]=(0,c.useState)(null!==(v=i.showDetails)&&void 0!==v&&v);return(0,n.jsxs)(n.Fragment,{children:[!1===L&&(0,n.jsxs)("div",{className:"conditional-container",children:[(0,n.jsxs)("div",{className:"buttons",children:[(0,n.jsx)(s.Button,{onClick:()=>P(!0),variant:"link",icon:g,size:"small",iconSize:20}),(0,n.jsx)(s.Button,{onClick:()=>o(e),variant:"link",icon:u,size:"small",iconSize:20})]}),(0,n.jsx)("div",{className:"info",children:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{children:(0,n.jsxs)("b",{children:["utm_medium"===w&&(0,t.__)("UTM Medium in URL:","planet4-gpch-plugin-optimize"),"utm_source"===w&&(0,t.__)("UTM Source in URL:","planet4-gpch-plugin-optimize"),"utm_campaign"===w&&(0,t.__)("UTM Campaign in URL:","planet4-gpch-plugin-optimize"),"url_parameter"===w&&(0,t.__)("URL Parameter:","planet4-gpch-plugin-optimize"),"local_storage"===w&&(0,t.__)("LocalStorage:","planet4-gpch-plugin-optimize"),"session_storage"===w&&(0,t.__)("SessionStorage:","planet4-gpch-plugin-optimize")]})}),("local_storage"===w||"session_storage"===w)&&(0,n.jsxs)("p",{children:[(0,t.__)("Name in storage:","planet4-gpch-plugin-optimize")," ",(0,n.jsx)("code",{children:S})," (",f,")"]}),(0,n.jsxs)("p",{children:[""!==B&&"exists"!==k&&"does_not_exist"!==k&&(0,n.jsx)("code",{children:B}),(0,n.jsxs)("span",{children:["is"===k&&" == ","is_not"===k&&" != ","contains"===k&&" contains ","does_not_contain"===k&&" does not contain ","exists"===k&&" exists ","does_not_exist"===k&&" does not exist"]}),"exists"!==k&&"does_not_exist"!==k&&(0,n.jsx)("code",{children:y})]})]})})]}),!0===L&&(0,n.jsxs)("div",{className:"conditional-container",children:[(0,n.jsx)(s.SelectControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:(0,t.__)("Force this variant when","planet4-gpch-plugin-optimize"),onChange:e=>{"utm_medium"===e?(z("url_parameter"),j(e),V("utm_medium")):"utm_source"===e?(z("url_parameter"),j(e),V("utm_source")):"utm_campaign"===e?(z("url_parameter"),j(e),V("utm_campaign")):(j(e),z(e))},options:[{label:(0,t.__)("Query parameter in URL","planet4-gpch-plugin-optimize"),value:"url_parameter"},{label:(0,t.__)("utm_medium in URL","planet4-gpch-plugin-optimize"),value:"utm_medium"},{label:(0,t.__)("utm_source in URL","planet4-gpch-plugin-optimize"),value:"utm_source"},{label:(0,t.__)("utm_campaign in URL","planet4-gpch-plugin-optimize"),value:"utm_campaign"},{label:(0,t.__)("Data in LocalStorage","planet4-gpch-plugin-optimize"),value:"local_storage"},{label:(0,t.__)("Data in SessionStorage","planet4-gpch-plugin-optimize"),value:"session_storage"}],value:w}),("local_storage"===w||"session_storage"===w)&&(0,n.jsx)(s.TextControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:(0,t.__)("Name in Storage","planet4-gpch-plugin-optimize"),onChange:b,value:S}),(0,n.jsxs)("div",{className:"conditional-details",children:[("local_storage"===w||"session_storage"===w)&&(0,n.jsx)(s.SelectControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:(0,t.__)("Data type","planet4-gpch-plugin-optimize"),onChange:C,options:[{label:(0,t.__)("String","planet4-gpch-plugin-optimize"),value:"string"},{label:(0,t.__)("Comma separated list","planet4-gpch-plugin-optimize"),value:"comma_separated"},{label:(0,t.__)("Object","planet4-gpch-plugin-optimize"),value:"object"}],value:f}),!("local_storage"===w&&"string"===f||"local_storage"===w&&"comma_separated"===f||"session_storage"===w&&"string"===f||"session_storage"===w&&"comma_separated"===f||"utm_medium"===w||"utm_source"===w||"utm_campaign"===w)&&(0,n.jsx)(s.TextControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:(0,t.__)("Key","planet4-gpch-plugin-optimize"),onChange:V,value:B}),(0,n.jsx)(s.SelectControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:(0,t.__)("Operator","planet4-gpch-plugin-optimize"),onChange:N,value:k,options:[..."comma_separated"!==f?[{label:(0,t.__)("is (==)","planet4-gpch-plugin-optimize"),value:"is"}]:[],..."comma_separated"!==f?[{label:(0,t.__)("is not (!=)","planet4-gpch-plugin-optimize"),value:"is_not"}]:[],{label:(0,t.__)("contains","planet4-gpch-plugin-optimize"),value:"contains"},{label:(0,t.__)("does not contain","planet4-gpch-plugin-optimize"),value:"does_not_contain"},{label:(0,t.__)("exists","planet4-gpch-plugin-optimize"),value:"exists"},{label:(0,t.__)("does not exist","planet4-gpch-plugin-optimize"),value:"does_not_exist"}]}),"exists"!==k&&"does_not_exist"!==k&&(0,n.jsx)(s.TextControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:(0,t.__)("Value","planet4-gpch-plugin-optimize"),onChange:M,value:y}),(0,n.jsx)(s.Button,{onClick:()=>(P(!1),void a({index:e,type:x,typeSelection:w,nameInStorage:S,dataType:f,conditionalKey:B,operator:k,value:y,showDetails:!1})),variant:"primary",children:(0,t.__)("Save","planet4-gpch-plugin-optimize")}),(0,n.jsx)(s.Button,{onClick:()=>o(e),variant:"secondary",isDestructive:!0,children:(0,t.__)("Remove","planet4-gpch-plugin-optimize")})]})]})]})},d=({conditionals:e,setAttributes:i})=>{const[a,o]=(0,c.useState)(0),l=t=>{e[t.index]=t},g=t=>{const n=e.filter(((e,i)=>i!==t));i({conditionals:n}),o(n.length)};return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(s.PanelBody,{title:(0,t.__)("Override Variant Targeting","planet4-gpch-plugin-optimize"),icon:r,initialOpen:!0,children:[(0,n.jsx)("p",{children:(0,n.jsx)("b",{children:(0,t.__)("Force this variant when either:","planet4-gpch-plugin-optimize")})}),(0,n.jsx)("div",{className:"conditionals-container",children:e.map(((e,t)=>(0,n.jsx)(_,{index:t,conditional:e,onSaveConditionals:l,onRemoveConditional:g},t)))}),(0,n.jsx)(s.Button,{__next40pxDefaultSize:!0,variant:"secondary",icon:p,iconSize:20,className:"add-conditional-button",onClick:()=>(i({conditionals:[...e,{showDetails:!0}]}),void o(a+1)),children:(0,t.__)("Add Condition","planet4-gpch-plugin-optimize")})]})})},{useSelect:m}=wp.data,h=JSON.parse('{"UU":"planet4-gpch-plugin-optimize/variant"}');(0,e.registerBlockType)(h.UU,{icon:function(){return(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",className:"icon",viewBox:"0 0 30.7 30.7",children:[(0,n.jsx)("path",{fill:"#131313",d:"M30 30.7h-8V3.5a1.6 1.6 0 0 1 1.6-1.6h4.7c1 0 1.6.8 1.6 1.6v27.2Zm-6.7-1.3h5.3V3.5c0-.2-.1-.3-.2-.3h-4.8l-.2.1v26.1Zm-4 1.3h-8V10c0-.8.7-1.4 1.5-1.4h5c.9 0 1.5.6 1.5 1.4v20.7Zm-6.6-1.3H18V10l-.2-.1h-5l-.2.1v19.4zm-4 1.3h-8V16.4c0-.8.7-1.3 1.4-1.3h5.3c.7 0 1.3.5 1.3 1.3zm-6.6-1.3h5.3v-13H2.1Z"}),(0,n.jsx)("path",{fill:"#121212",d:"M22.9 2.7h6.3v27h-6.3z"})]})},edit:function({attributes:e,setAttributes:i,context:r}){let{variantId:p,variantName:c,targetPercentage:g,conditionals:u}=e;if(void 0===p){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=8;p="";for(let i=0;i<t;i++)p+=e.charAt(Math.floor(Math.random()*e.length));i({variantId:p})}void 0===c&&(c=p),void 0===g&&(g=50),void 0===u&&(u=[]);const{currentPostLink:_}=m((e=>({currentPostLink:e("core/editor").getCurrentPost().link})),[]),h=`${_}${_.includes("?")?"&":"?"}force_variant=${encodeURIComponent(p)}`;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(l.InspectorControls,{children:[(0,n.jsxs)(s.PanelBody,{title:(0,t.__)("Variant Settings","planet4-gpch-plugin-optimize"),children:[(0,n.jsxs)("p",{children:[(0,n.jsx)("b",{children:"Variant ID: "}),p||""]}),(0,n.jsx)(s.TextControl,{__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0,label:(0,t.__)("Variant Name","planet4-gpch-plugin-optimize"),value:c||"",onChange:e=>i({variantName:e}),help:(0,t.__)("Used to identify the Variant in Mixpanel. Feel free to use a readable name. Don't change once the experiment has started!","planet4-gpch-plugin-optimize")}),(0,n.jsx)(s.Button,{__next40pxDefaultSize:!0,icon:a,variant:"link",href:h,target:"optimize-preview",rel:"noopener noreferrer",label:(0,t.__)("Opens the page for preview with this variant showing.","planet4-gpch-plugin-optimize"),showTooltip:!0,children:(0,t.__)("Preview Variant","planet4-gpch-plugin-optimize")})]}),(0,n.jsx)(s.PanelBody,{title:(0,t.__)("Targeting","planet4-gpch-plugin-optimize"),children:(0,n.jsx)(s.RangeControl,{__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0,label:"Target group percentage",afterIcon:o,value:g,onChange:e=>i({targetPercentage:e}),min:0,max:100,step:1,marks:[{value:25,label:"25%"},{value:50,label:"50%"},{value:75,label:"75%"},{value:100,label:"100%"}],railColor:"red",trackColor:"green"})}),(0,n.jsx)(d,{conditionals:u,setAttributes:i})]}),(0,n.jsx)("div",{children:(0,n.jsx)("div",{...(0,l.useBlockProps)(),children:e.variantId===r["content-optimization/editorSelectedVariantId"]&&(0,n.jsx)(l.InnerBlocks,{})})})]})},save:function({attributes:e}){return(0,n.jsx)("div",{...l.useBlockProps.save({className:"gp-optimize-variant"}),"data-target-percentage":e.targetPercentage,"data-variant-id":e.variantId,"data-variant-name":e.variantName,"data-conditionals":JSON.stringify(e.conditionals),children:(0,n.jsx)(l.InnerBlocks.Content,{})})}})}},i={};function n(e){var a=i[e];if(void 0!==a)return a.exports;var o=i[e]={exports:{}};return t[e](o,o.exports,n),o.exports}n.m=t,e=[],n.O=(t,i,a,o)=>{if(!i){var l=1/0;for(c=0;c<e.length;c++){for(var[i,a,o]=e[c],s=!0,r=0;r<i.length;r++)(!1&o||l>=o)&&Object.keys(n.O).every((e=>n.O[e](i[r])))?i.splice(r--,1):(s=!1,o<l&&(l=o));if(s){e.splice(c--,1);var p=a();void 0!==p&&(t=p)}}return t}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[i,a,o]},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={222:0,290:0};n.O.j=t=>0===e[t];var t=(t,i)=>{var a,o,[l,s,r]=i,p=0;if(l.some((t=>0!==e[t]))){for(a in s)n.o(s,a)&&(n.m[a]=s[a]);if(r)var c=r(n)}for(t&&t(i);p<l.length;p++)o=l[p],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return n.O(c)},i=globalThis.webpackChunkplanet4_gpch_plugin_optimize=globalThis.webpackChunkplanet4_gpch_plugin_optimize||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})();var a=n.O(void 0,[290],(()=>n(114)));a=n.O(a)})();